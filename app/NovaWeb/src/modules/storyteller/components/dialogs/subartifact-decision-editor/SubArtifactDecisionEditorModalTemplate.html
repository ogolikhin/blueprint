<script type="text/ng-template" id="includeTemplate.html">    
    <a href="" tabindex="-1" ng-bind-html="match.label | highlight:query" ng-attr-title="{{match.label}}"></a>
</script>
<div class="modal-header storyteller-modal-header">
    <h3 class="modal-title" style="display: inline-block">{{this.dialogModel.clonedDecision.label}}</h3>
    <h3 ng-show="!vm.isLabelAvailable()" class="modal-title" style="color: red; display: inline-block">{{::$root.config.labels['ST_TaskNameNotValid_Label']}}</h3>
    <div class="contextual-help-container contextual-help-modal-container">
        <contextual-help image-src={{'/Areas/Web/Style/images/Storyteller/contextual-help/decisionpoint.png'}}></contextual-help>
    </div>
</div>
<div class="modal-body storyteller-modal-body">
    <div>
        <div class="nova-form-group nova-floating-label">
            <input type="text" ng-class="dialogModel.clonedDecision.label ? 'nova-form-control input-is-dirty' : 'nova-form-control'" id="storyteller-action" ng-model="dialogModel.clonedDecision.label" maxlength="32" ng-disabled="vm.isReadonly">
            <label for="storyteller-action" class="nova-label"><i class="fonticon-storyteller-title"></i>{{::$root.config.labels['ST_Decision_Modal_Decision_Label']}}</label>
        </div>

        <div class="condition-list">
            <div class="row" ng-repeat="condition in dialogModel.conditions">
                <!-- branch group -->
                <div class="col-sm-7" style="display: inline-block">
                    <div class="nova-form-group nova-floating-label">
                        <input type="text" ng-class="condition.label ? 'nova-form-control input-is-dirty' : 'nova-form-control'" id="storyteller-new-condition-edge-{{$index}}" ng-model="condition.label" maxlength="{{::vm.CONDITION_MAX_LENGTH }}" ng-disabled="vm.isReadonly">
                        <label for="storyteller-new-condition-edge-{{$index}}" class="nova-label"><i class="fonticon-decision-diamond"></i>{{::$root.config.labels['ST_Decision_Modal_Decision_Condition_Label']}}</label>
                    </div>
                </div>

                <div class="col-sm-4">
                    <div class="nova-form-group nova-floating-label" ng-if="!vm.isFirstBranch(condition)">
                        <div class="btn-group btn-block">

                            <button id="storyteller-merge-node" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-disabled="vm.isReadonly">
                                <div class="dropdown-toggle-label">{{condition.mergeNode ? condition.mergeNode.label : 'Next Task'}} </div><span class="pull-right"><span class="caret"></span></span>
                            </button>
                            <ul class="dropdown-menu dropdown-next-node">
                                <li ng-repeat="node in condition.validMergeNodes">
                                    <a ng-click="condition.mergeNode = node" href="javascript:void(0);" ng-attr-title="{{ node.label }}"><i ng-class="vm.getNodeIcon(node)"></i>{{node.label}}</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>
                <div class="col-sm-1 delete-condition">
                    <button type="button" class="btn icon-btn" data-ng-click="vm.deleteCondition(condition)" title="{{::$root.config.labels['ST_Decision_Modal_Delete_Branch_Button_Title']}}" ng-if="!vm.hasMinConditions && !vm.isFirstBranch(condition)" ng-disabled="vm.isReadonly">
                        <span class="fonticon-delete"></span>
                    </button>
                </div>
            </div>
            <div id="decision-modal-list-bottom"></div>
        </div>

        <div>
            <button class="btn btn-default" type="button" ng-click="vm.addCondition()" ng-disabled="vm.hasMaxConditions || vm.isReadonly">{{::$root.config.labels['ST_Decision_Modal_Add_Condition_Button_Label']}}</button>
        </div>
    </div>

</div>

<div class="modal-footer storyteller-modal-footer">
    <button class="btn btn-default" type="button" ng-click="vm.cancel()">{{::$root.config.labels['Cancel']}}</button>
    <button class="btn button-brand-secondary" type="button" ng-click="vm.ok()" ng-disabled="vm.areMergeNodesEmpty() || vm.isReadonly">{{::$root.config.labels['OK']}}</button>
</div>
