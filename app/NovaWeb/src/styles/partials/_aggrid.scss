$aggrid-left-spacing: 10px;
$has-children-padding-before-arrow: 3px;

.project-tree,
.project-explorer {
  .ag-grid {
    height: 100%;
    padding-top: 5px;
    // removes focus globally inside ag-grid. May need to be reworked
    *:focus {
      outline: none;
    }

    .ag-font-style {
      font-size: $font-size-normal;
    }

    .ag-header-cell {
      text-align: left;

      .ag-header-cell-text {
        color: $brand-secondary;
        display: inline-block;
        font-weight: 600;
        text-indent: 6px;
      }
    }

    .ag-cell {
      height: $aggrid-row-height;
      overflow: visible;

      > span > span {
        display: inline-block;
        line-height: #{$aggrid-row-height - 2px};
      }

      .ag-group-contracted,
      .ag-group-expanded {
        border-color: transparent;
        border-style: solid;
        border-width: 1px 0 1px 1px;
      }

      .ag-group-inline-edit,
      .ag-group-value {
        border-color: transparent;
        border-style: solid;
        border-width: 1px;
        padding-right: 5px;
      }

      &.has-children {
        .ag-group-inline-edit,
        .ag-group-value {
          border-width: 1px 1px 1px 0;
        }
      }

      i {
        color: $brand-secondary;
        display: inline-block;
        height: #{$aggrid-row-height - 2px};
        vertical-align: bottom;
      }
    }

    .ag-group-inline-edit input {
      border: 0;
      box-sizing: border-box;
      color: $body-color;
      height: calc(#{$aggrid-row-height} - 2px);
      line-height: calc(#{$aggrid-row-height} - 2px);
      padding: 0 1px 1px 0;
      width: calc(100% - 20px); // 20px is the width of the icon
    }

    .has-children .ag-group-inline-edit input {
      width: calc(100% + 5px); // 5px is the padding due to the children indicator
    }
    // ag-grid has a bug which causes ag-row-group-expanded/contracted not to reflect the actual status
    .ag-group-contracted[style*='inline'],
    .ag-group-expanded[style*='inline'] {
      display: inline-block !important;
    }
    //    .ag-row.ag-row-group-contracted .ag-group-contracted,
    //    .ag-row.ag-row-group-expanded .ag-group-expanded {
    //      display: inline-block !important;
    //    }
    .ag-row:hover {
      .ag-group-expanded::before,
      .ag-group-contracted::before,
      span > span,
      *::before {
        background: $tree-hover-background;
      }

      .ag-group-contracted,
      .ag-group-expanded,
      .ag-group-value {
        border-color: $tree-hover-background;
      }
    }

    .ag-row-focus {
      .ag-group-expanded::before,
      .ag-group-contracted::before,
      span > span,
      *::before {
        background: $tree-focus-background !important;
      }

      .ag-group-contracted,
      .ag-group-expanded,
      .ag-group-value {
        border-color: $tree-focus-border !important;
      }
    }

    .ag-row-selected {
      .ag-group-expanded::before,
      .ag-group-contracted::before,
      span > span,
      *::before {
        background: $brand-secondary !important;
        color: $white !important;
      }

      > span .ag-group-inline-edit::before,
      > span .ag-group-value::before {
        color: $white !important;
      }

      .ag-group-contracted,
      .ag-group-expanded,
      .ag-group-inline-edit,
      .ag-group-value {
        border-color: $brand-secondary !important;
      }
    }
  }

  .ag-cell {
    > span .ag-group-contracted i::before,
    > span .ag-group-expanded i::before {
      box-sizing: border-box;
      color: $brand-secondary;
      display: inline-block;
      font-family: 'bp-line-icons';
      font-size: $font-size-big;
      font-style: normal;
      padding: 0 0 0 5px;
      text-align: left;
      vertical-align: bottom;
    }

    &.ag-cell-inline-editing .ag-group-value-wrapper span:not(.ag-group-inline-edit) {
      display: none !important;
    }
  }
  // vertical alignment adjustments
  .ag-body-container {
    padding-left: $aggrid-left-spacing;
    z-index: 0;

    .ag-row {
      width: calc(100% - #{$aggrid-left-spacing}) !important;

      &.ag-row-level-0 .ag-cell {
        > span {
          padding-left: 5px;
        }

        &.has-children > span {
          margin-left: -15px;
        }
      }
    }

    .ag-cell {
      width: calc(100% - #{$aggrid-left-spacing}) !important;

      &.has-children > span {
        margin-left: -$aggrid-left-spacing;
      }
    }

    .ag-row-group .ag-cell {
      margin-left: #{$aggrid-left-spacing / 2};
      width: calc(100% - #{0.5 * $aggrid-left-spacing}) !important;
    }
  }

  // icons for artifacts and folders
  .ag-cell .ag-group-value .ag-group-value-wrapper bp-item-type-icon {
    box-sizing: border-box;
    display: inline-block;
    font-size: 0;
    font-style: normal;
    padding: 0 0 0 5px;
    text-align: left;
    vertical-align: bottom;
    width: 25px;

    img {
      height: 12px;
      width: 12px;
    }
  }

  .ag-cell .ag-group-value .ag-group-value-wrapper i::before {
    box-sizing: border-box;
    color: $brand-secondary;
    content: '\e80e';
    display: inline-block;
    font-family: 'bp-line-icons';
    font-size: $font-size-big;
    font-style: normal;
    padding: 0 0 0 5px;
    text-align: left;
    vertical-align: bottom;
    width: 25px;
  }

  .ag-cell.is-business-process .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-business-process;
  }

  .ag-cell.is-domain-diagram .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-domain-diagram;
  }

  .ag-cell.is-actor .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-actor;
  }

  .ag-cell.is-use-case .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-use-case;
  }

  .ag-cell.is-process .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-process;
  }

  .ag-cell.is-user-story .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-user-story;
  }

  .ag-cell.is-use-case-diagram .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-use-case-diagram;
  }

  .ag-cell.is-ui-mockup .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-ui-mockup;
  }

  .ag-cell.is-textual-requirement .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-textual-requirement;
  }

  .ag-cell.is-storyboard .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-storyboard:;
  }

  .ag-cell.is-project .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-project;
  }

  .ag-cell.is-glossary .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-glossary;
  }

  .ag-cell.is-generic-diagram .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-generic-diagram;
  }

  .ag-cell.is-folder .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-folder;
  }

  .ag-row-group-expanded .ag-cell.is-folder .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-folder-open;
  }

  .ag-cell.is-document .ag-group-value .ag-group-value-wrapper i::before {
    content: $icon-document;
  }

  .ag-row-loading .ag-cell .ag-group-value .ag-group-value-wrapper i,
  .ag-row-loading .ag-cell .ag-group-value .ag-group-value-wrapper i {
    background: transparent !important;

    &::before {
      -webkit-animation: spin 1.5s infinite linear;
      -moz-animation: spin 1.5s infinite linear;
      -o-animation: spin 1.5s infinite linear;
      animation: spin 1.5s infinite linear;
      //animation-delay: .25s;
      background: transparent !important;
      content: '\e031' !important;
      font-family: 'Glyphicons Halflings' !important;
      opacity: 0;
      -ms-transform-origin: 50% 50%; // IE 9
      -webkit-transform-origin: 50% 50%;
      transform-origin: 50% 50%;
    }
  }

  .ag-cell.has-children {
    .ag-group-expanded i::before,
    .ag-group-contracted i::before {
      box-sizing: border-box;
      color: $body-color;
      display: inline-block;
      font-family: 'bp-font';
      font-size: $font-size-normal;
      padding-left: $has-children-padding-before-arrow;
      text-align: left;
    }

    .ag-group-expanded i::before {
      content: '\e81d';
    }

    .ag-group-contracted i::before {
      content: '\e81f';
    }
  }
}

.project-explorer {
  .ag-overlay-loading-wrapper {
    display: none;
  }

  .ag-cell {
    top: 2px;
  }
}

.project-tree {
  .ag-grid,
  .ag-grid > div {
    height: $project-picker-tree-height;
  }

  .ag-overlay-loading-wrapper {
    font-size: $font-size-normal;
    padding-top: $aggrid-row-height;
    text-align: left;
    vertical-align: top;
  }

  .ag-row-group.ag-row-level-0 .ag-cell {
    margin-left: 0;
    width: calc(100% - #{$aggrid-left-spacing}) !important;
  }
}

//drag and drop related styles
.project-explorer {
  .ag-row-draggable {
    .ag-group-value .ag-group-value-wrapper i::before,
    .ag-group-value .ag-group-value-wrapper bp-item-type-icon img {
      cursor: move;
    }
  }

  .ag-row:not(.drag-over) .ag-cell {
    z-index: 100;

    &.drag-enter {
      .ag-group-contracted,
      .ag-group-expanded,
      .ag-group-value {
        border-color: $body-color;
        border-style: dashed;
      }
    }
  }

  .ag-row.drag-over {
    cursor: move;
    opacity: .5;
  }

  .ag-row-dnd-pre,
  .ag-row-dnd-post {
    background: transparent;
    font-size: 0;
    height: 2px;
    position: absolute;
    width: calc(100% - 10px);
  }

  .ag-row-dnd-pre {
    top: -1px;
    z-index: 200;
  }

  .ag-row-dnd-post {
    bottom: -1px;
    z-index: 300;
  }

  .ag-row:not(.drag-over) .ag-row-dnd-pre.drag-enter,
  .ag-row:not(.drag-over) .ag-row-dnd-post.drag-enter {
    //generated with http://png-pixel.com/
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mPk+Q8AAR0BDcnX0+sAAAAASUVORK5CYII=) left repeat-x;
  }

  .ag-row:not(.drag-over) .ag-row-dnd-pre.drag-enter::before,
  .ag-row:not(.drag-over) .ag-row-dnd-post.drag-enter::before {
    border: solid 5px transparent;
    border-left: solid 5px $body-color;
    content: '';
    position: relative;
    top: 1px;
  }

  $aggrid-dnd-max-level: 5;

  @for $i from 0 through $aggrid-dnd-max-level - 1 {
    .ag-row-level-#{$i} + .ag-row-level-#{$i + 1} .ag-row-dnd-pre {
      z-index: 400;
    }
  }

  @for $i from $aggrid-dnd-max-level through 1 {
    @for $j from 0 through ($i - 1) {
      .ag-row-level-#{$i} + .ag-row-level-#{$j} .ag-row-dnd-pre {
        display: none;
      }
    }
  }
}

.artifact-picker {
  .project-name {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 560px;
    vertical-align: bottom;
  }

  .fonticon2-search {
    margin-left: 10px;

    &:before {
      padding-top: 17px;
    }
  }

  .grid-header {
    color: $brand-secondary;
    font-size: $font-size-normal;
    font-weight: 600;
    margin-bottom: -25px;
    position: relative;
    text-align: left;
    text-indent: 6px;
    z-index: 100;

    .navigate-back {
      cursor: pointer;
    }

    .fonticon2-arrow-double-left:before {
      font-size: 1rem;
      line-height: 1rem;
      margin-bottom: -10px;
      margin-left: -7px;
    }
  }

  .form-control.upper-text {
    float: left;
    margin-bottom: 15px;
    width: 95%;
  }
}
