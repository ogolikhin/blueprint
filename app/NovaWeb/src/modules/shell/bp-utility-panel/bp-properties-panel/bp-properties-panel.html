<div ng-if="$ctrl.isLoading" class="app-loading">
    <span class="glyphicon glyphicon-refresh spin"></span>
</div>

<div ng-if="!$ctrl.selectedArtifact &&
            !$ctrl.isLoading" class="empty-state">{{$ctrl.localization.get('App_UP_Properties_No_Properties')}}
</div>
<div ng-if="$ctrl.selectedArtifact && !$ctrl.hasArtifactEverBeenSavedOrPublished"
            class="empty-state">{{$ctrl.localization.get('App_UP_Properties_Unsaved_No_Properties')}}
</div>
<div class="artifact-overview" ng-if="!$ctrl.isLoading">
    <div class="content">
        <form novalidate name="$ctrl.form">
            <div class="properties system-properties__container" ng-class="{'is-collapsed': isSystemPropertiesCollapsed || !userInteracted}"
                 ng-if="$ctrl.isSystemPropertyAvailable">
                <div class="heading"
                     ng-click="isSystemPropertiesCollapsed = isSystemPropertiesCollapsed === undefined ? false : !isSystemPropertiesCollapsed; userInteracted = true;">
                    {{::$root.config.labels['App_Properties_System_Properties_Label']}}
                </div>
                <div class="system-properties content"
                     ng-class="{'is-collapsed': isSystemPropertiesCollapsed || !userInteracted}">
                    <formly-form model="$ctrl.model" fields="$ctrl.systemFields">
                    </formly-form>
                </div>
            </div>
            <div class="properties specific-properties__container" ng-class="{'is-collapsed': isSpecificPropertiesCollapsed}"
                 ng-if="$ctrl.isSpecificPropertyAvailable">
                <div class="heading" ng-click="isSpecificPropertiesCollapsed = !isSpecificPropertiesCollapsed">
                    {{::$ctrl.specificPropertiesHeading}}
                </div>
                <div class="content" ng-class="{'is-collapsed': isSpecificPropertiesCollapsed}">
                    <formly-form model="$ctrl.model" fields="$ctrl.specificFields">
                    </formly-form>
                </div>
            </div>
            <div class="properties additional-properties__container" ng-class="{'is-collapsed': isAdditionalPropertiesCollapsed}"
                 ng-if="$ctrl.isCustomPropertyAvailable">
                <div class="heading"
                     ng-click="isAdditionalPropertiesCollapsed = !isAdditionalPropertiesCollapsed">
                    {{::$root.config.labels['App_Properties_Additional_Properties_Label']}}
                </div>
                <div class="content" ng-class="{'is-collapsed': isAdditionalPropertiesCollapsed}">
                    <formly-form model="$ctrl.model" fields="$ctrl.customFields">
                    </formly-form>
                </div>
            </div>

            <tab-slider slide-selector=".uib-tab__tab" slide-select="$ctrl.setActive" ng-if="$ctrl.isRichTextPropertyAvailable">
                <uib-tabset active="$ctrl.activeTab">
                    <uib-tab ng-repeat="field in $ctrl.richTextFields track by $index"
                             select="$ctrl.activeTab = $index"
                             heading="{{field.data.name}}"
                             bp-tooltip="{{field.data.name}}" bp-tooltip-truncated="true"
                             class="uib-tab__tab {{field.templateOptions['isInvalid'] || !$ctrl.isRtfFieldValid(field) ? 'invalid' : ''}}">
                        <formly-form model="$ctrl.model" fields="[field]" ng-if="$ctrl.activeTab === $index" class="rich-text-wrapper">
                        </formly-form>
                    </uib-tab>
                </uib-tabset>
            </tab-slider>

        </form>
    </div>
</div>

